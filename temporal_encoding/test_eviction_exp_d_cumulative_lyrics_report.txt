==============================================================================
EXPERIMENT D: CUMULATIVE LYRICS OVER FULL VIDEO
==============================================================================
Report time: 2026-02-24T15:12:12
VIDEO_PATH=/root/autodl-tmp/diploma_project/temporal_encoding/202208312002.mp4
MAX_CACHE_TOKENS=150000, CHUNK_FRAMES=4, SAMPLE_FPS=2.0
ASK_INTERVAL=10, MAX_NEW_TOKENS=256

[1] Loading model...
[StreamQwenModel] Initialized. vision_start=151652, vision_end=151653
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:00<00:00, 19.10it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:00<00:00, 19.04it/s]
  VRAM after load: {'allocated': 7.105, 'reserved': 7.334, 'max_allocated': 7.105}

[2] Extracting sampled frames...
  Raw video: duration=200.2s, fps=30.31, frames=6068
  Sampled: 400 frames => 100 chunks

[3] Running streaming inference with sliding window...
âœ… VideoStreamingInference Engine Initialized (Chunk-Local / Append Mode).
   KV Cache Eviction: ON (max=150000, sink=auto, window=auto)
   ðŸ“ Auto-sink detected: first chunk = 5435 tokens (sink=5435, window=144565)
  Ask@chunk= 10, t~   20s, cache=53936, restore=âœ…
    cumulative: ç”¨èµ·ä¼çš„èƒŒå½±æŒ¡ä½å“­æ³£çš„å¿ƒ
æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬
è®¸å¤šçœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘
    current   : æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬
    + New lines (3): ['ç”¨èµ·ä¼çš„èƒŒå½±æŒ¡ä½å“­æ³£çš„å¿ƒ', 'æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬', 'è®¸å¤šçœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘']
  Ask@chunk= 20, t~   40s, cache=107826, restore=âœ…
    cumulative: ç”¨èµ·ä¼çš„èƒŒå½±æŒ¡ä½å“­æ³£çš„å¿ƒ
æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬
æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
é”™è¿‡æˆ‘æ²¡è¢«çœ‹è§é‚£ä¸ªè‡ªå·±
ç”¨ç®€å•çš„è¨€è¯­è§£å¼€è¶…è½½çš„å¿ƒ
    current   : æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
    + New lines (3): ['æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬', 'é”™è¿‡æˆ‘æ²¡è¢«çœ‹è§é‚£ä¸ªè‡ªå·±', 'ç”¨ç®€å•çš„è¨€è¯­è§£å¼€è¶…è½½çš„å¿ƒ']
  âœ‚ï¸ Eviction: 150938 â†’ 150000 tokens (-938)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 30, t~   60s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬
æœ‰äº›çœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘
è®¸å¤šçœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘
é”™è¿‡æˆ‘æ²¡è¢«çœ‹è§é‚£ä¸ªè‡ªå·±
ä½ çš„çƒ­æ³ªæ¯”æˆ‘æ¿€åŠ¨æ€œæƒœ
æˆ‘å‘èª“è¦æ›´åŠªåŠ› æ›´æœ‰å‹‡æ°”
ç­‰ä¸‹ä¸€ä¸ªå¤©äº®
åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—
    current   : åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—
    + New lines (4): ['æœ‰äº›çœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘', 'ä½ çš„çƒ­æ³ªæ¯”æˆ‘æ¿€åŠ¨æ€œæƒœ', 'æˆ‘å‘èª“è¦æ›´åŠªåŠ› æ›´æœ‰å‹‡æ°”', 'åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—']
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 40, t~   80s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
å®‰æ…•å¸Œ
å½“ç‡ƒå¥½é…¸å¥¶ ä¸€èµ·å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
ä½ çš„çƒ­æ³ªæ¯”æˆ‘æ¿€åŠ¨æ€œæƒœ
å®‰æ…•å¸Œ
æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
å®‰æ…•å¸Œ
æˆ‘å‘èª“è¦æ›´åŠªåŠ› æ›´æœ‰å‹‡æ°”
å®‰æ…•å¸Œ
ç­‰ä¸‹ä¸€ä¸ªå¤©äº®
å®‰æ…•å¸Œ
åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—

    current   : æ— æ–‡å­—ã€‚
    + New lines (2): ['æˆ‘å–œæ¬¢æˆ‘é£žèˆžçš„å¤´å‘', 'å’Œé£˜ç€é›¨è¿˜æ˜¯çœºæœ›çš„çœ¼å…‰']
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 50, t~  100s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
å®‰æ…•å¸Œ
å½“ç‡ƒå¥½é…¸å¥¶ ä¸€èµ·å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•
    current   : æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
    + New lines: 0
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 60, t~  120s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
å®‰æ…•å¸Œ
å½“ç‡ƒå¥½é…¸å¥¶ ä¸€èµ·å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
å®‰æ…•
    current   : åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—
    + New lines: 0
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 70, t~  140s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
å®‰æ…•å¸Œ
å½“ç‡ƒå¥½é…¸å¥¶ ä¸€èµ·å®‰æ…•å¸Œ
å®‰æ…•å¸Œ
ç­‰ä¸‹ä¸€ä¸ªå¤©äº®
å®‰æ…•å¸Œ
åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—
å®‰æ…•å¸Œ
ä½ çš„çƒ­æ³ªæ¯”æˆ‘æ¿€åŠ¨æ€œæƒœ
å®‰æ…•å¸Œ
æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
å®‰æ…•å¸Œ
æˆ‘å‘èª“è¦æ›´åŠªåŠ›æ›´æœ‰å‹‡æ°”
å®‰
    current   : æ— æ–‡å­—ã€‚
    + New lines (2): ['æˆ‘å‘èª“è¦æ›´åŠªåŠ›æ›´æœ‰å‹‡æ°”', 'ä½ çš„è‚©è†€æ˜¯æˆ‘è±è¾¾çš„å¤©å ‚']
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 80, t~  160s, cache=150000, restore=âœ…
    cumulative: æ—¶é—´å¯ä»¥ç£¨åŽ»æˆ‘çš„æ£±è§’
æœ‰äº›åšæŒå´æ°¸è¿œç£¨ä¸æŽ‰
å› ä¸ºæœ‰ä½ è¿™æ ·çš„ä¾é 
è¯·å®¹è®¸æˆ‘å°å°çš„éª„å‚²
    current   : æ— æ–‡å­—
    + New lines (4): ['æ—¶é—´å¯ä»¥ç£¨åŽ»æˆ‘çš„æ£±è§’', 'æœ‰äº›åšæŒå´æ°¸è¿œç£¨ä¸æŽ‰', 'å› ä¸ºæœ‰ä½ è¿™æ ·çš„ä¾é ', 'è¯·å®¹è®¸æˆ‘å°å°çš„éª„å‚²']
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk= 90, t~  180s, cache=150000, restore=âœ…
    cumulative: å®‰æ…•å¸Œ
ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«
è¯ å§šè‹¥é¾™
æ›² é™ˆå°éœž
åŽŸå”± éƒ­ é™
ç¼–æ›² æ´ªæ•¬å°§ è°¢æ˜Žç¥¥
    current   : æ— æ–‡å­—
    + New lines: 0
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  âœ‚ï¸ Eviction: 155389 â†’ 150000 tokens (-5389)
  Ask@chunk=100, t~  200s, cache=150000, restore=âœ…
    cumulative: è‘£ä¹¦å«ã€Šä¸‹ä¸€ä¸ªå¤©äº®ã€‹
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«å¯ä»¥
è‘£ä¹¦å«
    current   : æ— æ–‡å­—
    + New lines: 0

==============================================================================
FINAL DEDUPLICATED LYRICS (ORDERED BY FIRST APPEARANCE)
==============================================================================
[~20s] ç”¨èµ·ä¼çš„èƒŒå½±æŒ¡ä½å“­æ³£çš„å¿ƒ
[~20s] æœ‰äº›æ•…äº‹ä¸å¿…è¯´ç»™æ¯ä¸ªäººå¬
[~20s] è®¸å¤šçœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘
[~40s] æœ‰äº›æƒ…ç»ªæ˜¯è¯¥è¯´ç»™æ‡‚çš„äººå¬
[~40s] é”™è¿‡æˆ‘æ²¡è¢«çœ‹è§é‚£ä¸ªè‡ªå·±
[~40s] ç”¨ç®€å•çš„è¨€è¯­è§£å¼€è¶…è½½çš„å¿ƒ
[~60s] æœ‰äº›çœ¼ç›çœ‹å¾—å¤ªæµ…å¤ªè¿‘
[~60s] ä½ çš„çƒ­æ³ªæ¯”æˆ‘æ¿€åŠ¨æ€œæƒœ
[~60s] æˆ‘å‘èª“è¦æ›´åŠªåŠ› æ›´æœ‰å‹‡æ°”
[~60s] åŽ»ä¸Šæ¬¡ç‰µæ‰‹èµèŠ±é‚£é‡Œæ•£æ­¥å¥½å—
[~80s] æˆ‘å–œæ¬¢æˆ‘é£žèˆžçš„å¤´å‘
[~80s] å’Œé£˜ç€é›¨è¿˜æ˜¯çœºæœ›çš„çœ¼å…‰
[~140s] æˆ‘å‘èª“è¦æ›´åŠªåŠ›æ›´æœ‰å‹‡æ°”
[~140s] ä½ çš„è‚©è†€æ˜¯æˆ‘è±è¾¾çš„å¤©å ‚
[~160s] æ—¶é—´å¯ä»¥ç£¨åŽ»æˆ‘çš„æ£±è§’
[~160s] æœ‰äº›åšæŒå´æ°¸è¿œç£¨ä¸æŽ‰
[~160s] å› ä¸ºæœ‰ä½ è¿™æ ·çš„ä¾é 
[~160s] è¯·å®¹è®¸æˆ‘å°å°çš„éª„å‚²

Total unique lines: 18

==============================================================================
ANALYSIS
==============================================================================
Total chunks processed: 100/100
Total asks: 10
All snapshot/restore valid: True
Avg TTFT cumulative ask: 0.387s
Avg TTFT current ask: 0.379s
Final cache_len: 150000
Total evictions: 73
Total tokens evicted: 388946
Total runtime: 550.2s

Pass/Fail checks:
  [D1] Full-video sliding completed: âœ…
  [D2] All ask restore cache: âœ…
  [D3] Extracted enough unique lyric lines (>=6): âœ…
  [D4] cache_len <= max_cache_tokens: âœ…

ðŸŽ‰ EXPERIMENT D PASSED
